# LikeLib 2.0

To run the node, a configuration file must be specified for it.
By default it is config.json file of the following format:

```
{
    "net": {
        "listen_addr": "0.0.0.0:20203",
        "public_port": 20203
    },
    "rpc": {
        "address": "0.0.0.0:50051"
    },
    "miner": {
        "threads": 4
    },
    "nodes": [
        "127.0.0.1:20204",
        "127.0.0.1:20205"
    ],
    "keys_dir": ".",
    "database": {
        "path": "likelib/database",
        "clean": false
    }
}
```

Notes on parameters:
* `net.listen_addr` - specifies local address and port that the server will listen on;
* `net.public_port` - when node is connected to a remote machine over Internet, its 
public IP gets known, but port - doesn't. We only know the client-socket IP address.
Such things as port-forwarding with NAT, may change the port we need to connect to;
* `rpc.address` - address on which RPC is listening on;
* `miner.threads` - optional parameter, sets the number of threads that miner is using;
* `nodes` - list of known nodes.
* `keys_dir` - key(public and private that was generated by client) folder path. 
if file not exists generate new key pair and save by this path.
* `database.path` - path to folder with database files (will be created if not exists).
* `database.clean` - if true - cleans database; otherwise does nothing.


## Build
1. Run: "sudo .doc/prepare_build.sh". It will install conan and its dependencies.
2. To generate CMake files use cmake command: cmake -DCMAKE_BUILD_TYPE=Release ..
3. To build project use make command: make -j $(nproc)
4. Go to the bin folder and create config.json with the node settings in it.
5. Run the node (keys for the node will be created automatically, if you want to use the already existing ones
you should put them manually in the node work folder): ./node

## Client 
After the build, run the client in the bin folder to see the text with help.

Example case of smart contract:

1. We already have a raised node with rpc 127.0.0.1:50051
2. Compile the solidity code with the following command: 
./client compile --code "path to the solidity code".
After that we will get the folder with contract names containing the compiled contract code and json files contracts.
3. Then we create contract with with the next command:
./client create_contract --host 127.0.0.1:50051 --code "Path_to_compiled_contract" --amount 0 --fee 100000 --keys ../../doc/base-account-keys
As a result we get the contract address. (For example 692a70D2e424a56D2C6C27aA97D1)
4. The following command is used to call up the contract:
./client message_call --host 127.0.0.1:50051 --to 692a70D2e424a56D2C6C27aA97D1 --amount 0 --fee 100000 --keys ../../doc/base-account-keys --message (12065fe0)
In order to take the input, you need to run the command from the bin folder:
./client encode --code "Path to compiled contract" --data "getCodeAddressSize(Address(25o9qdcrVUTdMBtCAeAnxU2uaj3D))"
getCodeAddressSize-called function, Address(25o9qdcrVUTdMBtCAeAnxU2uaj3D)-function call parameter(only parameters with type Address are written as Address(...))
5. After the call we will get the result of the contract, in order to see the readable result from the bin folder the following command is started:
./client decode --code "Path to compiled contract" --method "getCodeAddressSize" --data (call result)

